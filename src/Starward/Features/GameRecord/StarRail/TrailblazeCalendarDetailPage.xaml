<?xml version="1.0" encoding="utf-8" ?>
<sf:PageBase x:Class="Starward.Features.GameRecord.StarRail.TrailblazeCalendarDetailPage"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:calendar="using:Starward.Core.GameRecord.StarRail.TrailblazeCalendar"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:lang="using:Starward.Language"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:sf="using:Starward.Frameworks"
             x:DefaultBindMode="OneWay"
             mc:Ignorable="d">

    <Grid Padding="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  Page Title with Back Button  -->
        <Grid Grid.Row="0" ColumnSpacing="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            
            <Button Grid.Column="0"
                    Width="40"
                    Height="40"
                    Padding="0"
                    VerticalAlignment="Center"
                    Background="Transparent"
                    BorderThickness="0"
                    Click="BackButton_Click">
                <FontIcon FontSize="16" Glyph="&#xE72B;" />
            </Button>
            
            <TextBlock Grid.Column="1"
                       VerticalAlignment="Center"
                       FontSize="24"
                       FontWeight="Bold"
                       Text="{x:Bind PageTitle}" />
        </Grid>

        <!--  Filter Controls  -->
        <Grid Grid.Row="1"
              Margin="0,24,0,16"
              Padding="16"
              Background="{ThemeResource CustomOverlayAcrylicBrush}"
              ColumnSpacing="16"
              CornerRadius="8"
              RowSpacing="12"
              Shadow="{ThemeResource ThemeShadow}"
              Translation="0,0,16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!--  Type Filter - Toggle Buttons  -->
            <StackPanel Grid.Row="0"
                        Grid.Column="0"
                        VerticalAlignment="Bottom"
                        Orientation="Horizontal"
                        Spacing="0">
                <ToggleButton x:Name="ToggleButton_StellarJade"
                              MinWidth="100"
                              Click="TypeToggleButton_Click"
                              CornerRadius="4,0,0,4"
                              IsChecked="{x:Bind IsStellarJadeSelected, Mode=OneWay}"
                              Tag="1">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <Image Width="20"
                               Height="20"
                               Source="ms-appx:///Assets/Image/900001.png" />
                        <TextBlock Text="{x:Bind lang:Lang.TrailblazeCalendarPage_StellarJadeDetails}" />
                    </StackPanel>
                </ToggleButton>
                <ToggleButton x:Name="ToggleButton_Pass"
                              MinWidth="100"
                              Click="TypeToggleButton_Click"
                              CornerRadius="0,4,4,0"
                              IsChecked="{x:Bind IsPassSelected, Mode=OneWay}"
                              Tag="2">
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <Image Width="20"
                               Height="20"
                               Source="ms-appx:///Assets/Image/101.png" />
                        <TextBlock Text="{x:Bind lang:Lang.TrailblazeCalendarPage_PassDetails}" />
                    </StackPanel>
                </ToggleButton>
            </StackPanel>

            <!--  Year Filter  -->
            <ComboBox Grid.Row="0"
                      Grid.Column="1"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Bottom"
                      Header="{x:Bind lang:Lang.Common_Year}"
                      ItemsSource="{x:Bind AvailableYears}"
                      SelectedItem="{x:Bind SelectedYear, Mode=TwoWay}" />

            <!--  Month Filter  -->
            <ComboBox Grid.Row="0"
                      Grid.Column="2"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Bottom"
                      Header="{x:Bind lang:Lang.Common_Month}"
                      ItemsSource="{x:Bind AvailableMonths}"
                      SelectedItem="{x:Bind SelectedMonth, Mode=TwoWay}" />

            <!--  Action Name Filter  -->
            <ComboBox Grid.Row="0"
                      Grid.Column="3"
                      HorizontalAlignment="Stretch"
                      VerticalAlignment="Bottom"
                      Header="{x:Bind lang:Lang.TrailblazeCalendarPage_FilterByName}"
                      ItemsSource="{x:Bind ActionNames}"
                      SelectedItem="{x:Bind SelectedActionName, Mode=TwoWay}" />

            <!--  Statistics  -->
            <StackPanel Grid.Row="1"
                        Grid.ColumnSpan="4"
                        Orientation="Horizontal"
                        Spacing="24">
                <StackPanel Orientation="Horizontal" Spacing="4">
                    <TextBlock Foreground="{ThemeResource TextFillColorSecondaryBrush}" Text="共" />
                    <TextBlock FontWeight="SemiBold"
                               Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                               Text="{x:Bind RecordCount, Mode=OneWay}" />
                    <TextBlock Foreground="{ThemeResource TextFillColorSecondaryBrush}" Text="条记录" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" Spacing="4">
                    <TextBlock Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="{x:Bind lang:Lang.TrailblazeCalendarPage_TotalAmount}" />
                    <TextBlock FontWeight="SemiBold"
                               Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                               Text="{x:Bind TotalAmount, Mode=OneWay}" />
                </StackPanel>
            </StackPanel>
        </Grid>

        <!--  Transaction List  -->
        <Border Grid.Row="2"
                Padding="0"
                Background="{ThemeResource CustomOverlayAcrylicBrush}"
                CornerRadius="8"
                Shadow="{ThemeResource ThemeShadow}"
                Translation="0,0,16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!--  List Header  -->
                <Grid Grid.Row="0"
                      Padding="16,12,16,12"
                      BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                      BorderThickness="0,0,0,1"
                      ColumnSpacing="16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="180" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="120" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="{x:Bind lang:Lang.TrailblazeCalendarPage_Time}" />
                    <TextBlock Grid.Column="1"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="{x:Bind lang:Lang.TrailblazeCalendarPage_Source}" />
                    <TextBlock Grid.Column="2"
                               HorizontalAlignment="Right"
                               FontWeight="SemiBold"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="{x:Bind lang:Lang.TrailblazeCalendarPage_Amount}" />
                </Grid>

                <!--  List Content  -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                    <ItemsRepeater Margin="0,8,0,8" ItemsSource="{x:Bind FilteredDetailItems}">
                        <ItemsRepeater.ItemTemplate>
                            <DataTemplate x:DataType="calendar:TrailblazeCalendarDetailItem">
                                <Grid Padding="16,8,16,8" ColumnSpacing="16">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="180" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="120" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                               VerticalAlignment="Center"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               Text="{x:Bind Time}" />
                                    <TextBlock Grid.Column="1"
                                               VerticalAlignment="Center"
                                               Text="{x:Bind ActionName}"
                                               TextWrapping="Wrap" />
                                    <StackPanel Grid.Column="2"
                                                HorizontalAlignment="Right"
                                                Orientation="Horizontal"
                                                Spacing="6">
                                        <Image Width="20"
                                               Height="20"
                                               VerticalAlignment="Center"
                                               Source="{x:Bind IconPath}" />
                                        <TextBlock VerticalAlignment="Center"
                                                   FontSize="15"
                                                   FontWeight="SemiBold"
                                                   Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}">
                                            <Run Text="+" /><Run Text="{x:Bind Number}" />
                                        </TextBlock>
                                    </StackPanel>
                                </Grid>
                            </DataTemplate>
                        </ItemsRepeater.ItemTemplate>
                    </ItemsRepeater>
                </ScrollViewer>

                <!--  Empty State  -->
                <StackPanel Grid.Row="1"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="16"
                            Visibility="{x:Bind IsEmptyState, Mode=OneWay}">
                    <Image Width="120"
                           Height="120"
                           Opacity="0.5"
                           Source="{StaticResource EmojiPom}" />
                    <TextBlock HorizontalAlignment="Center"
                               FontSize="16"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="{x:Bind lang:Lang.HoyolabToolboxPage_NoData}" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</sf:PageBase>

